
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Capstone-AdaReg}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \section{Prediction of United States' Counties Poverty
Rates}\label{prediction-of-united-states-counties-poverty-rates}

Mark Vervuurt 19-01-2018

\subsection{Executive Summary}\label{executive-summary}

This document presents the results of the regression analysis to predict
poverty rates of United States' Counties.

A regression model which uses an AdaBoostRegressor was created. This
AdaBoostRegressor is able to predict United States' Counties poverty
rates with an RMSE of 2.7853.

\begin{longtable}[]{@{}ll@{}}
\toprule
Model & RMSE\tabularnewline
\midrule
\endhead
AdaBoostRegressor & 2.7853\tabularnewline
Linear Regression & 2.9297\tabularnewline
\bottomrule
\end{longtable}

In the data understanding phase was discovered that the following
features play a significant role in predicting United States' counties
poverty rates. They have moderate positive and negative Pearson
correlation coefficients. Futhermore the Boxplots show enough variation
and separation of the data with respect to the target variable
poverty\_rate.

\begin{longtable}[]{@{}ll@{}}
\toprule
\begin{minipage}[b]{0.71\columnwidth}\raggedright\strut
Significant Features\strut
\end{minipage} & \begin{minipage}[b]{0.14\columnwidth}\raggedright\strut
Short Description\strut
\end{minipage}\tabularnewline
\midrule
\endhead
\begin{minipage}[t]{0.71\columnwidth}\raggedright\strut
area\_\_rucc\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright\strut
Rural urban continuum code of county\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.71\columnwidth}\raggedright\strut
econ\_\_economic\_typology\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright\strut
economic dependence type of county\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.71\columnwidth}\raggedright\strut
aui\_pct65y\_cat\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright\strut
created categorical feature combining 'area\_\_urban\_influence' \n and
categorical percentage of 65 years old per county\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.71\columnwidth}\raggedright\strut
demo\_\_pct\_adults\_less\_than\_a\_high\_school\_diploma\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright\strut
percentage of adults with less than high school diploma per county\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.71\columnwidth}\raggedright\strut
health\_\_homicides\_per\_100k\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright\strut
homocides per 100k inhabitants per county\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.71\columnwidth}\raggedright\strut
econ\_\_pct\_unemployment\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright\strut
percentage of unemployement per county\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.71\columnwidth}\raggedright\strut
health\_\_pct\_low\_birthweight\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright\strut
percentage of low birth weight per county\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.71\columnwidth}\raggedright\strut
econ\_\_pct\_uninsured\_adults\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright\strut
percentage of uninsured adults per county\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.71\columnwidth}\raggedright\strut
health\_\_pct\_diabetes\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright\strut
percentage of diabetes per county\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.71\columnwidth}\raggedright\strut
demo\_\_pct\_non\_hispanic\_african\_american\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright\strut
percentage of african americans per county\strut
\end{minipage}\tabularnewline
\begin{minipage}[t]{0.71\columnwidth}\raggedright\strut
econ\_\_pct\_civilian\_labor\strut
\end{minipage} & \begin{minipage}[t]{0.14\columnwidth}\raggedright\strut
percentage of civilan labor per county\strut
\end{minipage}\tabularnewline
\bottomrule
\end{longtable}

The CRISP-DM Methodology was used in order to create an accurate
regression model:

\begin{itemize}
\tightlist
\item
  \textbf{Business Understanding}: read through the
  '\href{https://www.ers.usda.gov/topics/rural-economy-population/rural-poverty-well-being/poverty-overview.aspx}{Rural
  Poverty \& Well-being}' report to better understand the circumstances
  of poverty.
\item
  \textbf{Data Understanding}: explore the quantitative and categorical
  variables that play a key role in predicting poverty rates.
\item
  \textbf{Data Preparation}: drop redundant and uninformative features,
  fill missing values, etc.
\item
  \textbf{Modeling}: create and select the best regression model.
\item
  \textbf{Evaluation}: evaluate the regression models using nested cross
  validation.
\item
  \textbf{Deployment}: the deployment of the regression model is not
  strictly applicable here. However presenting the results of the
  regression analysis with this report can be considered as the
  deployment step.
\end{itemize}

\subsection{Business Understanding}\label{business-understanding}

As described in the online report the
'\href{https://www.ers.usda.gov/topics/rural-economy-population/rural-poverty-well-being/poverty-overview.aspx}{Rural
Poverty \& Well-being}': "Concentrated poverty contributes to poor
housing and health conditions, higher crime and school dropout rates, as
well as employment dislocations". With this information the data will be
explored to see how health, crime,education and employement related
factors contribute to poverty.

Another important feature of poverty is time. An area that doesn't have
a high level of poverty in two following years is likely better off than
an area that has a high level of poverty in both years. It will not be
possible to construct a feature with this information because we cannot
compare the state's poverty rate over year 'a' and 'b' within this data
set. We dont have a unique key to identify counties.

Counties are generally compared by their Non-Metro and Metro status.
There is more poverty in Non-Metro areas than Metro areas. Poverty is
also higher under certain ages and etnicities. Here also the data will
be explored on the basis of this information.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{k+kn}{import} \PY{n+nn}{re}
        \PY{k+kn}{import} \PY{n+nn}{bs4}
        \PY{k+kn}{import} \PY{n+nn}{time}
        \PY{k+kn}{import} \PY{n+nn}{plyfile}
        \PY{k+kn}{import} \PY{n+nn}{html5lib}
        \PY{k+kn}{import} \PY{n+nn}{multiprocessing}
        \PY{k+kn}{import} \PY{n+nn}{itertools}
        
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        
        \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
        \PY{k+kn}{from} \PY{n+nn}{scipy} \PY{k}{import} \PY{n}{misc}
        \PY{k+kn}{import} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{io}\PY{n+nn}{.}\PY{n+nn}{wavfile} \PY{k}{as} \PY{n+nn}{wavfile}
        
        \PY{k+kn}{import} \PY{n+nn}{scipy}
        \PY{k+kn}{from} \PY{n+nn}{math} \PY{k}{import} \PY{n}{sqrt}
        \PY{k+kn}{from} \PY{n+nn}{scipy} \PY{k}{import} \PY{n}{stats}
        \PY{k+kn}{from} \PY{n+nn}{pprint} \PY{k}{import} \PY{n}{pprint}
        \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{tree}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{svm} \PY{k}{import} \PY{n}{SVC}
        \PY{k+kn}{from} \PY{n+nn}{sklearn} \PY{k}{import} \PY{n}{manifold}
        \PY{k+kn}{from} \PY{n+nn}{tempfile} \PY{k}{import} \PY{n}{mkdtemp}
        \PY{k+kn}{from} \PY{n+nn}{textwrap} \PY{k}{import} \PY{n}{wrap}
        \PY{k+kn}{from} \PY{n+nn}{matplotlib} \PY{k}{import} \PY{n}{cm} \PY{k}{as} \PY{n}{cm}
        
        \PY{k+kn}{import} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{as} \PY{n+nn}{metrics}
        \PY{k+kn}{from} \PY{n+nn}{pandas}\PY{n+nn}{.}\PY{n+nn}{plotting} \PY{k}{import} \PY{n}{scatter\PYZus{}matrix}
        \PY{k+kn}{from} \PY{n+nn}{scipy}\PY{n+nn}{.}\PY{n+nn}{stats} \PY{k}{import} \PY{n}{randint} \PY{k}{as} \PY{n}{sp\PYZus{}randint}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{pipeline} \PY{k}{import} \PY{n}{TransformerMixin}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics}\PY{n+nn}{.}\PY{n+nn}{scorer} \PY{k}{import} \PY{n}{make\PYZus{}scorer}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{pipeline} \PY{k}{import} \PY{n}{Pipeline}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{decomposition} \PY{k}{import} \PY{n}{PCA}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{datasets} \PY{k}{import} \PY{n}{load\PYZus{}iris}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{pipeline} \PY{k}{import} \PY{n}{make\PYZus{}pipeline}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{Binarizer}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{naive\PYZus{}bayes} \PY{k}{import} \PY{n}{MultinomialNB}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{tree} \PY{k}{import} \PY{n}{DecisionTreeRegressor}\PY{p}{,} \PY{n}{DecisionTreeClassifier}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{neighbors} \PY{k}{import} \PY{n}{KNeighborsClassifier}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}selection} \PY{k}{import} \PY{n}{RFECV}\PY{p}{,} \PY{n}{SelectFromModel}\PY{p}{,} \PY{n}{f\PYZus{}regression}\PY{p}{,} \PY{n}{SelectKBest}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{ensemble} \PY{k}{import} \PY{n}{RandomForestClassifier}\PY{p}{,} \PY{n}{AdaBoostRegressor}\PY{p}{,} \PY{n}{AdaBoostClassifier}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{dummy} \PY{k}{import} \PY{n}{DummyClassifier}\PY{p}{,} \PY{n}{DummyRegressor}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{cluster} \PY{k}{import} \PY{n}{AgglomerativeClustering}\PY{p}{,} \PY{n}{KMeans}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{feature\PYZus{}extraction}\PY{n+nn}{.}\PY{n+nn}{text} \PY{k}{import} \PY{n}{CountVectorizer}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k}{import} \PY{n}{LinearRegression}\PY{p}{,} \PY{n}{LassoCV}\PY{p}{,} \PY{n}{RidgeCV}\PY{p}{,} \PY{n}{Lasso}\PY{p}{,} \PY{n}{Ridge}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{MaxAbsScaler}\PY{p}{,} \PY{n}{MinMaxScaler}\PY{p}{,} \PY{n}{Normalizer}\PY{p}{,} \PY{n}{RobustScaler}\PY{p}{,} \PY{n}{StandardScaler}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{recall\PYZus{}score}\PY{p}{,} \PY{n}{accuracy\PYZus{}score}\PY{p}{,} \PY{n}{confusion\PYZus{}matrix}\PY{p}{,} \PY{n}{roc\PYZus{}curve}\PY{p}{,} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{,} \PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{,} \PY{n}{accuracy\PYZus{}score}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split}\PY{p}{,} \PY{n}{GridSearchCV}\PY{p}{,} \PY{n}{RandomizedSearchCV}\PY{p}{,} \PY{n}{cross\PYZus{}val\PYZus{}score}\PY{p}{,} \PY{n}{cross\PYZus{}validate}\PY{p}{,} \PY{n}{cross\PYZus{}val\PYZus{}predict}\PY{p}{,} \PY{n}{KFold}\PY{p}{,} \PY{n}{ShuffleSplit}\PY{p}{,} \PY{n}{StratifiedShuffleSplit}
        
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{k+kn}{from} \PY{n+nn}{matplotlib} \PY{k}{import} \PY{n}{cm} \PY{k}{as} \PY{n}{cm}
        \PY{k+kn}{from} \PY{n+nn}{mpl\PYZus{}toolkits}\PY{n+nn}{.}\PY{n+nn}{mplot3d} \PY{k}{import} \PY{n}{Axes3D}
        \PY{k+kn}{from} \PY{n+nn}{pandas}\PY{n+nn}{.}\PY{n+nn}{plotting} \PY{k}{import} \PY{n}{parallel\PYZus{}coordinates}\PY{p}{,} \PY{n}{andrews\PYZus{}curves}
        
        \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
        \PY{n}{matplotlib}\PY{o}{.}\PY{n}{style}\PY{o}{.}\PY{n}{use}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ggplot}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{n}{pd}\PY{o}{.}\PY{n}{set\PYZus{}option}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{display.max\PYZus{}columns}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{k+kc}{None}\PY{p}{)}
\end{Verbatim}


    \subsection{Data Understanding}\label{data-understanding}

In order to build this regression model and determine its most
significant features a thorough data exploration was done to understand
the relationship between poverty rates and other features. \#\#\#
Initial Data Exploration The dataset consists of 3198 records about
United States' counties. Each record contains socioeconomic indicators
about a United States' county for a given year. Besides the 'row\_id',
'yr' and the target value 'poverty\_rate', the dataset contains 32
features about socioeconomic indicators.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{n}{poverty\PYZus{}train} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./Microsoft\PYZus{}\PYZhy{}\PYZus{}DAT102x\PYZus{}Predicting\PYZus{}Poverty\PYZus{}in\PYZus{}the\PYZus{}United\PYZus{}States\PYZus{}\PYZhy{}\PYZus{}Training\PYZus{}values.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{n}{poverty\PYZus{}train}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}3}]:} (3198, 34)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{n}{poverty\PYZus{}train}\PY{o}{.}\PY{n}{dtypes}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}4}]:} row\_id                                                int64
        area\_\_rucc                                           object
        area\_\_urban\_influence                                object
        econ\_\_economic\_typology                              object
        econ\_\_pct\_civilian\_labor                            float64
        econ\_\_pct\_unemployment                              float64
        econ\_\_pct\_uninsured\_adults                          float64
        econ\_\_pct\_uninsured\_children                        float64
        demo\_\_pct\_female                                    float64
        demo\_\_pct\_below\_18\_years\_of\_age                     float64
        demo\_\_pct\_aged\_65\_years\_and\_older                   float64
        demo\_\_pct\_hispanic                                  float64
        demo\_\_pct\_non\_hispanic\_african\_american             float64
        demo\_\_pct\_non\_hispanic\_white                        float64
        demo\_\_pct\_american\_indian\_or\_alaskan\_native         float64
        demo\_\_pct\_asian                                     float64
        demo\_\_pct\_adults\_less\_than\_a\_high\_school\_diploma    float64
        demo\_\_pct\_adults\_with\_high\_school\_diploma           float64
        demo\_\_pct\_adults\_with\_some\_college                  float64
        demo\_\_pct\_adults\_bachelors\_or\_higher                float64
        demo\_\_birth\_rate\_per\_1k                             float64
        demo\_\_death\_rate\_per\_1k                             float64
        health\_\_pct\_adult\_obesity                           float64
        health\_\_pct\_adult\_smoking                           float64
        health\_\_pct\_diabetes                                float64
        health\_\_pct\_low\_birthweight                         float64
        health\_\_pct\_excessive\_drinking                      float64
        health\_\_pct\_physical\_inacticity                     float64
        health\_\_air\_pollution\_particulate\_matter            float64
        health\_\_homicides\_per\_100k                          float64
        health\_\_motor\_vehicle\_crash\_deaths\_per\_100k         float64
        health\_\_pop\_per\_dentist                             float64
        health\_\_pop\_per\_primary\_care\_physician              float64
        yr                                                   object
        dtype: object
\end{Verbatim}
            
    \paragraph{Individual Feature
Statistics}\label{individual-feature-statistics}

Here are the summary statistics for all the socioeconomic features: -
summary statistics of categorical variables: the total count (count),
number of unique elements (unique), most frequent element (top) and the
frequency of the most frequent element (frequent) - summary statistics
of quantitative variables: the mean, the standard deviation (std), the
minimum value (min), 25\% percentile, 50\% percentile (median), 75\%
percentile and the maximum value (max).

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{n}{poverty\PYZus{}train}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{row\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{n}{include}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{all}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}5}]:}                                                area\_\_rucc  \textbackslash{}
        count                                                3198   
        unique                                                  9   
        top     Nonmetro - Urban population of 2,500 to 19,999{\ldots}   
        freq                                                  608   
        mean                                                  NaN   
        std                                                   NaN   
        min                                                   NaN   
        25\%                                                   NaN   
        50\%                                                   NaN   
        75\%                                                   NaN   
        max                                                   NaN   
        
                                            area\_\_urban\_influence  \textbackslash{}
        count                                                3198   
        unique                                                 12   
        top     Small-in a metro area with fewer than 1 millio{\ldots}   
        freq                                                  692   
        mean                                                  NaN   
        std                                                   NaN   
        min                                                   NaN   
        25\%                                                   NaN   
        50\%                                                   NaN   
        75\%                                                   NaN   
        max                                                   NaN   
        
               econ\_\_economic\_typology  econ\_\_pct\_civilian\_labor  \textbackslash{}
        count                     3198               3198.000000   
        unique                       6                       NaN   
        top             Nonspecialized                       NaN   
        freq                      1266                       NaN   
        mean                       NaN                  0.467071   
        std                        NaN                  0.074541   
        min                        NaN                  0.217000   
        25\%                        NaN                  0.420000   
        50\%                        NaN                  0.467000   
        75\%                        NaN                  0.514000   
        max                        NaN                  1.000000   
        
                econ\_\_pct\_unemployment  econ\_\_pct\_uninsured\_adults  \textbackslash{}
        count               3198.00000                 3196.000000   
        unique                     NaN                         NaN   
        top                        NaN                         NaN   
        freq                       NaN                         NaN   
        mean                   0.05961                    0.217534   
        std                    0.02285                    0.067372   
        min                    0.00800                    0.046000   
        25\%                    0.04400                    0.166000   
        50\%                    0.05700                    0.216000   
        75\%                    0.07100                    0.262000   
        max                    0.24000                    0.495000   
        
                econ\_\_pct\_uninsured\_children  demo\_\_pct\_female  \textbackslash{}
        count                    3196.000000       3196.000000   
        unique                           NaN               NaN   
        top                              NaN               NaN   
        freq                             NaN               NaN   
        mean                        0.085920          0.498781   
        std                         0.040005          0.024251   
        min                         0.009000          0.294000   
        25\%                         0.057000          0.493000   
        50\%                         0.077000          0.503000   
        75\%                         0.105000          0.512000   
        max                         0.285000          0.576000   
        
                demo\_\_pct\_below\_18\_years\_of\_age  demo\_\_pct\_aged\_65\_years\_and\_older  \textbackslash{}
        count                       3196.000000                        3196.000000   
        unique                              NaN                                NaN   
        top                                 NaN                                NaN   
        freq                                NaN                                NaN   
        mean                           0.227763                           0.170137   
        std                            0.034291                           0.043594   
        min                            0.098000                           0.043000   
        25\%                            0.207000                           0.142000   
        50\%                            0.226000                           0.167000   
        75\%                            0.245250                           0.194000   
        max                            0.417000                           0.355000   
        
                demo\_\_pct\_hispanic  demo\_\_pct\_non\_hispanic\_african\_american  \textbackslash{}
        count          3196.000000                              3196.000000   
        unique                 NaN                                      NaN   
        top                    NaN                                      NaN   
        freq                   NaN                                      NaN   
        mean              0.090233                                 0.091117   
        std               0.142707                                 0.147104   
        min               0.000000                                 0.000000   
        25\%               0.019000                                 0.006000   
        50\%               0.035000                                 0.022000   
        75\%               0.088000                                 0.096250   
        max               0.945000                                 0.855000   
        
                demo\_\_pct\_non\_hispanic\_white  \textbackslash{}
        count                    3196.000000   
        unique                           NaN   
        top                              NaN   
        freq                             NaN   
        mean                        0.770207   
        std                         0.207903   
        min                         0.060000   
        25\%                         0.648000   
        50\%                         0.854000   
        75\%                         0.936000   
        max                         0.998000   
        
                demo\_\_pct\_american\_indian\_or\_alaskan\_native  demo\_\_pct\_asian  \textbackslash{}
        count                                   3196.000000      3196.000000   
        unique                                          NaN              NaN   
        top                                             NaN              NaN   
        freq                                            NaN              NaN   
        mean                                       0.024659         0.013304   
        std                                        0.084634         0.025366   
        min                                        0.000000         0.000000   
        25\%                                        0.002000         0.003000   
        50\%                                        0.007000         0.007000   
        75\%                                        0.014000         0.013000   
        max                                        0.852000         0.346000   
        
                demo\_\_pct\_adults\_less\_than\_a\_high\_school\_diploma  \textbackslash{}
        count                                        3198.000000   
        unique                                               NaN   
        top                                                  NaN   
        freq                                                 NaN   
        mean                                            0.148794   
        std                                             0.068255   
        min                                             0.016129   
        25\%                                             0.097468   
        50\%                                             0.133501   
        75\%                                             0.195171   
        max                                             0.466867   
        
                demo\_\_pct\_adults\_with\_high\_school\_diploma  \textbackslash{}
        count                                 3198.000000   
        unique                                        NaN   
        top                                           NaN   
        freq                                          NaN   
        mean                                     0.350300   
        std                                      0.070534   
        min                                      0.072821   
        25\%                                      0.305915   
        50\%                                      0.355701   
        75\%                                      0.399197   
        max                                      0.551689   
        
                demo\_\_pct\_adults\_with\_some\_college  \textbackslash{}
        count                          3198.000000   
        unique                                 NaN   
        top                                    NaN   
        freq                                   NaN   
        mean                              0.301366   
        std                               0.052498   
        min                               0.112821   
        25\%                               0.265362   
        50\%                               0.301595   
        75\%                               0.335972   
        max                               0.474216   
        
                demo\_\_pct\_adults\_bachelors\_or\_higher  demo\_\_birth\_rate\_per\_1k  \textbackslash{}
        count                            3198.000000              3198.000000   
        unique                                   NaN                      NaN   
        top                                      NaN                      NaN   
        freq                                     NaN                      NaN   
        mean                                0.199540                11.676986   
        std                                 0.089158                 2.739516   
        min                                 0.013986                 4.000000   
        25\%                                 0.138840                10.000000   
        50\%                                 0.177247                11.000000   
        75\%                                 0.233258                13.000000   
        max                                 0.794872                29.000000   
        
                demo\_\_death\_rate\_per\_1k  health\_\_pct\_adult\_obesity  \textbackslash{}
        count               3198.000000                3196.000000   
        unique                      NaN                        NaN   
        top                         NaN                        NaN   
        freq                        NaN                        NaN   
        mean                  10.301126                   0.307599   
        std                    2.786143                   0.043404   
        min                    0.000000                   0.140000   
        25\%                    8.000000                   0.284000   
        50\%                   10.000000                   0.309000   
        75\%                   12.000000                   0.334000   
        max                   27.000000                   0.484000   
        
                health\_\_pct\_adult\_smoking  health\_\_pct\_diabetes  \textbackslash{}
        count                 2734.000000           3196.000000   
        unique                        NaN                   NaN   
        top                           NaN                   NaN   
        freq                          NaN                   NaN   
        mean                     0.213519              0.109287   
        std                      0.063090              0.023197   
        min                      0.050000              0.033000   
        25\%                      0.171000              0.094000   
        50\%                      0.211000              0.109000   
        75\%                      0.249750              0.124000   
        max                      0.526000              0.197000   
        
                health\_\_pct\_low\_birthweight  health\_\_pct\_excessive\_drinking  \textbackslash{}
        count                   3016.000000                     2220.000000   
        unique                          NaN                             NaN   
        top                             NaN                             NaN   
        freq                            NaN                             NaN   
        mean                       0.083534                        0.164832   
        std                        0.022382                        0.050232   
        min                        0.025000                        0.038000   
        25\%                        0.068000                        0.129000   
        50\%                        0.080000                        0.164000   
        75\%                        0.095000                        0.196000   
        max                        0.232000                        0.358000   
        
                health\_\_pct\_physical\_inacticity  \textbackslash{}
        count                       3196.000000   
        unique                              NaN   
        top                                 NaN   
        freq                                NaN   
        mean                           0.277309   
        std                            0.052947   
        min                            0.097000   
        25\%                            0.243000   
        50\%                            0.280000   
        75\%                            0.313000   
        max                            0.443000   
        
                health\_\_air\_pollution\_particulate\_matter  health\_\_homicides\_per\_100k  \textbackslash{}
        count                                3170.000000                 1231.000000   
        unique                                       NaN                         NaN   
        top                                          NaN                         NaN   
        freq                                         NaN                         NaN   
        mean                                   11.626498                    5.950747   
        std                                     1.544928                    5.063374   
        min                                     7.000000                   -0.390000   
        25\%                                    10.000000                    2.660000   
        50\%                                    12.000000                    4.840000   
        75\%                                    13.000000                    7.825000   
        max                                    15.000000                   51.490000   
        
                health\_\_motor\_vehicle\_crash\_deaths\_per\_100k  health\_\_pop\_per\_dentist  \textbackslash{}
        count                                   2781.000000              2954.000000   
        unique                                          NaN                      NaN   
        top                                             NaN                      NaN   
        freq                                            NaN                      NaN   
        mean                                      21.116077              3431.442789   
        std                                       10.516984              2569.444414   
        min                                        3.090000               339.000000   
        25\%                                       13.460000              1812.250000   
        50\%                                       19.630000              2690.000000   
        75\%                                       26.470000              4089.750000   
        max                                      110.450000             28129.000000   
        
                health\_\_pop\_per\_primary\_care\_physician    yr  
        count                              2968.000000  3198  
        unique                                     NaN     2  
        top                                        NaN     a  
        freq                                       NaN  1599  
        mean                               2551.349730   NaN  
        std                                2100.475931   NaN  
        min                                 189.000000   NaN  
        25\%                                1419.000000   NaN  
        50\%                                1999.000000   NaN  
        75\%                                2859.000000   NaN  
        max                               23400.000000   NaN  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{n}{poverty\PYZus{}labels} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Microsoft\PYZus{}\PYZhy{}\PYZus{}DAT102x\PYZus{}Predicting\PYZus{}Poverty\PYZus{}in\PYZus{}the\PYZus{}United\PYZus{}States\PYZus{}\PYZhy{}\PYZus{}Training\PYZus{}labels.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{poverty\PYZus{}labels}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}7}]:} (3198, 2)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{poverty\PYZus{}labels}\PY{o}{.}\PY{n}{dtypes}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}8}]:} row\_id            int64
        poverty\_rate    float64
        dtype: object
\end{Verbatim}
            
    Here are the summary statistics for the target variable which is
quantitative:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n}{poverty\PYZus{}labels}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{row\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}9}]:}        poverty\_rate
        count   3198.000000
        mean      16.817136
        std        6.697969
        min        2.500000
        25\%       12.000000
        50\%       15.800000
        75\%       20.300000
        max       47.400000
\end{Verbatim}
            
    Poverty rates are right or positively skewed with a skew value of
1.048357. We can recognize a slight bell curve in the data. The mean and
median are relatively close to each other and the standard deviation is
relatively low which indicates low variability in the poverty rates.
Most United States' counties have a poverty\_rate between 10\% and 20\%
poverty.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}104}]:} \PY{n}{ht\PYZus{}pov} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{distplot}\PY{p}{(}\PY{n}{poverty\PYZus{}labels}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{row\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dodgerblue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Histogram poverty\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_14_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{n}{poverty} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{merge}\PY{p}{(}\PY{n}{poverty\PYZus{}train}\PY{p}{,} \PY{n}{poverty\PYZus{}labels}\PY{p}{,} \PY{n}{on}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{row\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{poverty}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}11}]:} (3198, 35)
\end{Verbatim}
            
    From the summary statistics above, should be clear that there are three
categorical variables included in the dataset: - area\_\_rucc with 9
values: - 'Nonmetro - Urban population of 2,500 to 19,999, adjacent to a
metro area' counties are most frequent with 608 counties. - 'Nonmetro -
Urban population of 20,000 or more, not adjacent to a metro area'
counties are most infrequent with 100 counties. -
area\_\_urban\_influence with 12 values: - 'Small-in a metro area with
fewer than 1 million residents' counties are most frequent with 692
counties. - 'Noncore not adjacent to a metro/micro area and contains a
town of 2,500 or more residents' counties are most infrequent with 122.
- econ\_\_economic\_typology with 6 values: - 'Non specialized' economic
typology counties are most frequent with 1266 counties. -
'Mining-dependent' economic typologpy counties are most infrequent with
254 counties.

Here under the barplots speak for themselves.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n}{bh\PYZus{}ar} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{countplot}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{area\PYZus{}\PYZus{}rucc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{poverty}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dodgerblue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Barplot area\PYZus{}rucc}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_17_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{bh\PYZus{}aui} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{countplot}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{area\PYZus{}\PYZus{}urban\PYZus{}influence}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{poverty}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dodgerblue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Barplot area\PYZus{}\PYZus{}urban\PYZus{}influence}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_18_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{n}{bh\PYZus{}eet} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{countplot}\PY{p}{(}\PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{econ\PYZus{}\PYZus{}economic\PYZus{}typology}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{poverty}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dodgerblue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Barplot econ\PYZus{}\PYZus{}economic\PYZus{}typology}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_19_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Data Exploration and Visualization of Categorical
Variables}\label{data-exploration-and-visualization-of-categorical-variables}

Here the predictive value of the categorical variables
'econ\_\_economic\_typology', 'area\_\_urban\_influence', 'area\_\_rucc'
and 'yr' is explored. Boxplots are used to explore these categorical
variables.

    The boxplots of the categorical variables 'econ\_\_economic\_typology',
'area\_\_urban\_influence' and 'area\_\_rucc' show interesting
variation: * 'Farm-dependent' counties have the lowest poverty rates and
'Federal/State government-dependent' counties have the highest poverty
rates. * 'Large-in a metro area with at least 1 million residents or
more' counties have the lowest poverty rates. * 'Metro - Counties in
metro areas with 1 million population or more' counties have the lowest
poverty rates.

Furthermore by combining features more interesting categorical variables
can be created explaining much more of the variance in poverty rates. *
'demo\_\_pct\_aged\_65\_years\_and\_older' and
'area\_\_urban\_influence'. The general trend is that counties with a
low percentage population of "65 years or older" have a higher poverty
rate.

The difference in poverty over year 'a' and 'b' is really minimal.
Furthermore it doesn't make sense to use this feature to predict poverty
rates. This feature will be droped at the cleaning stage.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{n}{bpd\PYZus{}ar} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{boxplot}\PY{p}{(}\PY{n}{orient}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{h}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{poverty\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{area\PYZus{}\PYZus{}rucc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{poverty}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dodgerblue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Boxplot poverty\PYZus{}rate by area\PYZus{}rucc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{bpd\PYZus{}eet} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{boxplot}\PY{p}{(}\PY{n}{orient}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{h}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{poverty\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{econ\PYZus{}\PYZus{}economic\PYZus{}typology}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{poverty}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dodgerblue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Boxplot poverty\PYZus{}rate by econ\PYZus{}\PYZus{}economic\PYZus{}typology}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_23_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{k}{def} \PY{n+nf}{create\PYZus{}old\PYZus{}age\PYZus{}cat}\PY{p}{(}\PY{n}{input\PYZus{}df}\PY{p}{)}\PY{p}{:}
             \PY{n}{low\PYZus{}pct\PYZus{}olds} \PY{o}{=} \PY{n}{poverty}\PY{o}{.}\PY{n}{demo\PYZus{}\PYZus{}pct\PYZus{}aged\PYZus{}65\PYZus{}years\PYZus{}and\PYZus{}older} \PY{o}{\PYZlt{}} \PY{l+m+mf}{0.167000}
             \PY{n}{high\PYZus{}pct\PYZus{}olds} \PY{o}{=} \PY{n}{poverty}\PY{o}{.}\PY{n}{demo\PYZus{}\PYZus{}pct\PYZus{}aged\PYZus{}65\PYZus{}years\PYZus{}and\PYZus{}older} \PY{o}{\PYZgt{}} \PY{l+m+mf}{0.167000}
             \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{low\PYZus{}pct\PYZus{}olds}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pct\PYZus{}65years\PYZus{}cat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{low\PYZus{}pct\PYZus{}65years}\PY{l+s+s1}{\PYZsq{}}
             \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{high\PYZus{}pct\PYZus{}olds}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pct\PYZus{}65years\PYZus{}cat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{high\PYZus{}pct\PYZus{}65years}\PY{l+s+s1}{\PYZsq{}}
             
             \PY{n}{age\PYZus{}old\PYZus{}cats} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{low\PYZus{}pct\PYZus{}65years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{high\PYZus{}pct\PYZus{}65years}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
             \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pct\PYZus{}65years\PYZus{}cat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{pct\PYZus{}65years\PYZus{}cat}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{category}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pct\PYZus{}65years\PYZus{}cat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{pct\PYZus{}65years\PYZus{}cat}\PY{o}{.}\PY{n}{cat}\PY{o}{.}\PY{n}{set\PYZus{}categories}\PY{p}{(}\PY{n}{age\PYZus{}old\PYZus{}cats}\PY{p}{,} \PY{n}{ordered}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             \PY{k}{return} \PY{n}{input\PYZus{}df}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{n}{poverty} \PY{o}{=} \PY{n}{create\PYZus{}old\PYZus{}age\PYZus{}cat}\PY{p}{(}\PY{n}{poverty}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{k}{def} \PY{n+nf}{create\PYZus{}aui\PYZus{}pct65y\PYZus{}cat}\PY{p}{(}\PY{n}{input\PYZus{}df}\PY{p}{)}\PY{p}{:}
             \PY{n}{aui\PYZus{}cats} \PY{o}{=} \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{area\PYZus{}\PYZus{}urban\PYZus{}influence}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}
             \PY{n}{pct65y\PYZus{}cats} \PY{o}{=} \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{pct\PYZus{}65years\PYZus{}cat}\PY{o}{.}\PY{n}{cat}\PY{o}{.}\PY{n}{categories}
             
             \PY{n}{aui\PYZus{}pct65y\PYZus{}masks} \PY{o}{=} \PY{p}{[} \PY{p}{(}\PY{p}{(}\PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{area\PYZus{}\PYZus{}urban\PYZus{}influence} \PY{o}{==} \PY{n}{aui}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{pct\PYZus{}65years\PYZus{}cat} \PY{o}{==} \PY{n}{pct65y}\PY{p}{)}
                                   \PY{p}{,} \PY{n}{aui} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{pct65y}\PY{p}{)} 
                                 \PY{k}{for} \PY{p}{(}\PY{n}{aui}\PY{p}{,} \PY{n}{pct65y}\PY{p}{)} \PY{o+ow}{in} \PY{n+nb}{list}\PY{p}{(}\PY{n}{itertools}\PY{o}{.}\PY{n}{product}\PY{p}{(}\PY{n}{aui\PYZus{}cats}\PY{p}{,} \PY{n}{pct65y\PYZus{}cats}\PY{p}{)}\PY{p}{)}\PY{p}{]}
         
             \PY{n}{aui\PYZus{}pct65y\PYZus{}lbls} \PY{o}{=} \PY{p}{[}\PY{n}{aui} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{, }\PY{l+s+s1}{\PYZsq{}} \PY{o}{+} \PY{n}{pct65y} \PY{k}{for} \PY{p}{(}\PY{n}{aui}\PY{p}{,} \PY{n}{pct65y}\PY{p}{)}  
                             \PY{o+ow}{in} \PY{n+nb}{list}\PY{p}{(}\PY{n}{itertools}\PY{o}{.}\PY{n}{product}\PY{p}{(}\PY{n}{aui\PYZus{}cats}\PY{p}{,} \PY{n}{pct65y\PYZus{}cats}\PY{p}{)}\PY{p}{)}\PY{p}{]}
               
             \PY{k}{for} \PY{n}{mask}\PY{p}{,} \PY{n}{aui\PYZus{}pct65y\PYZus{}lb} \PY{o+ow}{in} \PY{n}{aui\PYZus{}pct65y\PYZus{}masks}\PY{p}{:}
                 \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{mask}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{aui\PYZus{}pct65y\PYZus{}cat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{aui\PYZus{}pct65y\PYZus{}lb}
                 
             \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{aui\PYZus{}pct65y\PYZus{}cat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{aui\PYZus{}pct65y\PYZus{}cat}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{category}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{aui\PYZus{}pct65y\PYZus{}cat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{aui\PYZus{}pct65y\PYZus{}cat}\PY{o}{.}\PY{n}{cat}\PY{o}{.}\PY{n}{set\PYZus{}categories}\PY{p}{(}\PY{n}{aui\PYZus{}pct65y\PYZus{}lbls}\PY{p}{)}
             \PY{k}{return} \PY{n}{input\PYZus{}df}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n}{poverty} \PY{o}{=} \PY{n}{create\PYZus{}aui\PYZus{}pct65y\PYZus{}cat}\PY{p}{(}\PY{n}{poverty}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
         \PY{n}{bpd\PYZus{}eet} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{boxplot}\PY{p}{(}\PY{n}{orient}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{h}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{x}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{poverty\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{aui\PYZus{}pct65y\PYZus{}cat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{data}\PY{o}{=}\PY{n}{poverty}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dodgerblue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Boxplot poverty\PYZus{}rate by area\PYZus{}\PYZus{}urban\PYZus{}influence }\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{ and categorical percentage 65 years old}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_27_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Data Exploration and Visualization of Quantitative
Variables}\label{data-exploration-and-visualization-of-quantitative-variables}

For the quantitative variables the correlation matrix is computed first
followed by the visual display of the scatterplot matrices.

    \paragraph{Correlation matrix}\label{correlation-matrix}

The strongest correlations observed are moderate positive and negative
for the following features: -
demo\_\_pct\_adults\_less\_than\_a\_high\_school\_diploma\\
- health\_\_homicides\_per\_100k\\
- econ\_\_pct\_unemployment\\
- health\_\_pct\_low\_birthweight\\
- econ\_\_pct\_uninsured\_adults\\
- health\_\_pct\_diabetes\\
- demo\_\_pct\_non\_hispanic\_african\_american\\
- econ\_\_pct\_civilian\_labor

The whole correlation matrix of interest is shown here under.

\begin{longtable}[]{@{}ll@{}}
\toprule
Features & Pearson Correlation Coefficient\tabularnewline
\midrule
\endhead
econ\_\_pct\_civilian\_labor & -0.670417\tabularnewline
demo\_\_pct\_non\_hispanic\_white & -0.499974\tabularnewline
demo\_\_pct\_adults\_bachelors\_or\_higher & -0.467134\tabularnewline
demo\_\_pct\_adults\_with\_some\_college & -0.363875\tabularnewline
health\_\_pct\_excessive\_drinking & -0.353254\tabularnewline
demo\_\_pct\_asian & -0.163033\tabularnewline
demo\_\_pct\_aged\_65\_years\_and\_older & -0.088123\tabularnewline
demo\_\_pct\_female & -0.068065\tabularnewline
demo\_\_pct\_below\_18\_years\_of\_age & 0.039237\tabularnewline
health\_\_air\_pollution\_particulate\_matter & 0.058582\tabularnewline
econ\_\_pct\_uninsured\_children & 0.098882\tabularnewline
demo\_\_pct\_hispanic & 0.105574\tabularnewline
demo\_\_birth\_rate\_per\_1k & 0.127506\tabularnewline
health\_\_pop\_per\_primary\_care\_physician & 0.156942\tabularnewline
demo\_\_pct\_adults\_with\_high\_school\_diploma &
0.202928\tabularnewline
demo\_\_pct\_american\_indian\_or\_alaskan\_native &
0.236508\tabularnewline
demo\_\_death\_rate\_per\_1k & 0.244093\tabularnewline
health\_\_pop\_per\_dentist & 0.268996\tabularnewline
health\_\_pct\_adult\_smoking & 0.395457\tabularnewline
health\_\_motor\_vehicle\_crash\_deaths\_per\_100k &
0.420348\tabularnewline
health\_\_pct\_physical\_inacticity & 0.437680\tabularnewline
health\_\_pct\_adult\_obesity & 0.444293\tabularnewline
demo\_\_pct\_non\_hispanic\_african\_american & 0.507048\tabularnewline
health\_\_pct\_diabetes & 0.537038\tabularnewline
econ\_\_pct\_uninsured\_adults & 0.541712\tabularnewline
health\_\_pct\_low\_birthweight & 0.565456\tabularnewline
econ\_\_pct\_unemployment & 0.592022\tabularnewline
health\_\_homicides\_per\_100k & 0.621399\tabularnewline
demo\_\_pct\_adults\_less\_than\_a\_high\_school\_diploma &
0.680360\tabularnewline
\bottomrule
\end{longtable}

    \paragraph{Scatter plot matrices}\label{scatter-plot-matrices}

After reading the
'\href{https://www.ers.usda.gov/topics/rural-economy-population/rural-poverty-well-being/poverty-overview.aspx}{Rural
Poverty \& Well-being}' report it is clear that education, ethnicity and
health related issues play an important role in predicting poverty. In
this dataset are also added economic indicators of United States'
counties. The scatterplot matrices of these four groups of socioeconomic
indicators are shown here under. The scatter plot matrices visually
confirms the finding of the correlation matrix.

NB: linear statistical transformations (sqrt, square, exponential, etc)
were also applied to the target variable 'poverty\_rate' but they did
not improve substantially the correlation coefficients and the
scatterplot matrices.

    The correlation matrices and scatterplot matrices visually confirm that
the variables correlate moderatly strong with the target variable
'poverty\_rate' seem to have a linear relationship.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{n}{sns}\PY{o}{.}\PY{n}{set}\PY{p}{(}\PY{n}{style}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{ticks}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{scatter\PYZus{}educ} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{pairplot}\PY{p}{(}\PY{n}{poverty}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{demo\PYZus{}\PYZus{}pct\PYZus{}adults\PYZus{}less\PYZus{}than\PYZus{}a\PYZus{}high\PYZus{}school\PYZus{}diploma}\PY{l+s+s1}{\PYZsq{}}
                                                       \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{demo\PYZus{}\PYZus{}pct\PYZus{}adults\PYZus{}with\PYZus{}high\PYZus{}school\PYZus{}diploma}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{demo\PYZus{}\PYZus{}pct\PYZus{}adults\PYZus{}with\PYZus{}some\PYZus{}college}\PY{l+s+s1}{\PYZsq{}}
                                                       \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{demo\PYZus{}\PYZus{}pct\PYZus{}adults\PYZus{}bachelors\PYZus{}or\PYZus{}higher}\PY{l+s+s1}{\PYZsq{}}
                                                       \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{poverty\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_32_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{n}{scatter\PYZus{}health1} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{pairplot}\PY{p}{(}\PY{n}{poverty}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health\PYZus{}\PYZus{}pct\PYZus{}adult\PYZus{}obesity}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health\PYZus{}\PYZus{}pct\PYZus{}adult\PYZus{}smoking}\PY{l+s+s1}{\PYZsq{}}
                                                       \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health\PYZus{}\PYZus{}pct\PYZus{}diabetes}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health\PYZus{}\PYZus{}pct\PYZus{}low\PYZus{}birthweight}\PY{l+s+s1}{\PYZsq{}}
                                                       \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health\PYZus{}\PYZus{}pct\PYZus{}excessive\PYZus{}drinking}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health\PYZus{}\PYZus{}pct\PYZus{}physical\PYZus{}inacticity}\PY{l+s+s1}{\PYZsq{}}
                                                       \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{poverty\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_33_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{n}{scatter\PYZus{}health2} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{pairplot}\PY{p}{(}\PY{n}{poverty}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health\PYZus{}\PYZus{}homicides\PYZus{}per\PYZus{}100k}\PY{l+s+s1}{\PYZsq{}}
                                                       \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health\PYZus{}\PYZus{}motor\PYZus{}vehicle\PYZus{}crash\PYZus{}deaths\PYZus{}per\PYZus{}100k}\PY{l+s+s1}{\PYZsq{}}
                                                       \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health\PYZus{}\PYZus{}pop\PYZus{}per\PYZus{}dentist}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health\PYZus{}\PYZus{}pop\PYZus{}per\PYZus{}primary\PYZus{}care\PYZus{}physician}\PY{l+s+s1}{\PYZsq{}}
                                                       \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{poverty\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_34_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{n}{scatter\PYZus{}econ} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{pairplot}\PY{p}{(}\PY{n}{poverty}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{econ\PYZus{}\PYZus{}pct\PYZus{}civilian\PYZus{}labor}\PY{l+s+s1}{\PYZsq{}}
                                                       \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{econ\PYZus{}\PYZus{}pct\PYZus{}unemployment}\PY{l+s+s1}{\PYZsq{}}
                                                       \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{econ\PYZus{}\PYZus{}pct\PYZus{}uninsured\PYZus{}adults}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{econ\PYZus{}\PYZus{}pct\PYZus{}uninsured\PYZus{}children}\PY{l+s+s1}{\PYZsq{}}
                                                       \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{poverty\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_35_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{n}{scatter\PYZus{}ethnic} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{pairplot}\PY{p}{(}\PY{n}{poverty}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{demo\PYZus{}\PYZus{}pct\PYZus{}hispanic}\PY{l+s+s1}{\PYZsq{}}
                                                       \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{demo\PYZus{}\PYZus{}pct\PYZus{}non\PYZus{}hispanic\PYZus{}african\PYZus{}american}\PY{l+s+s1}{\PYZsq{}}
                                                       \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{demo\PYZus{}\PYZus{}pct\PYZus{}non\PYZus{}hispanic\PYZus{}white}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{demo\PYZus{}\PYZus{}pct\PYZus{}american\PYZus{}indian\PYZus{}or\PYZus{}alaskan\PYZus{}native}\PY{l+s+s1}{\PYZsq{}}
                                                       \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{demo\PYZus{}\PYZus{}pct\PYZus{}asian}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{demo\PYZus{}\PYZus{}pct\PYZus{}female}\PY{l+s+s1}{\PYZsq{}}
                                                       \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{poverty\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_36_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    These quantitative features behave like categorical features.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{n}{scatter\PYZus{}non\PYZus{}ln} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{pairplot}\PY{p}{(}\PY{n}{poverty}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{demo\PYZus{}\PYZus{}death\PYZus{}rate\PYZus{}per\PYZus{}1k}\PY{l+s+s1}{\PYZsq{}}
                                                       \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{demo\PYZus{}\PYZus{}birth\PYZus{}rate\PYZus{}per\PYZus{}1k}\PY{l+s+s1}{\PYZsq{}}
                                                       \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health\PYZus{}\PYZus{}air\PYZus{}pollution\PYZus{}particulate\PYZus{}matter}\PY{l+s+s1}{\PYZsq{}}
                                                       \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{poverty\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{size}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_38_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \paragraph{Creation and Visualization of New Categorical
Variables}\label{creation-and-visualization-of-new-categorical-variables}

From observing the scatterplot matrices of the features
'demo\_\_death\_rate\_per\_1k', 'demo\_\_birth\_rate\_per\_1k' and
'health\_\_air\_pollution\_particulate\_matter' is clear that these
quantitative variables behave like categorical variables. They will be
transformed into categorical features by binning them.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{k}{def} \PY{n+nf}{create\PYZus{}birthrate\PYZus{}cat}\PY{p}{(}\PY{n}{input\PYZus{}df}\PY{p}{)}\PY{p}{:}
             \PY{n}{cats} \PY{o}{=} \PY{p}{[} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{birthrate }\PY{l+s+si}{\PYZob{}0\PYZcb{}}\PY{l+s+s2}{ \PYZhy{} }\PY{l+s+si}{\PYZob{}1\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{i}\PY{p}{,} \PY{n}{i} \PY{o}{+} \PY{l+m+mi}{5}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{40}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{)} \PY{p}{]}
             \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{birth\PYZus{}rate\PYZus{}cat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{cut}\PY{p}{(}\PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{demo\PYZus{}\PYZus{}birth\PYZus{}rate\PYZus{}per\PYZus{}1k}\PY{p}{,} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{45}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{)}\PY{p}{,} \PY{n}{right}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{include\PYZus{}lowest}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{labels}\PY{o}{=}\PY{n}{cats}\PY{p}{)}
             \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{birth\PYZus{}rate\PYZus{}cat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{birth\PYZus{}rate\PYZus{}cat}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{category}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{birth\PYZus{}rate\PYZus{}cat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{birth\PYZus{}rate\PYZus{}cat}\PY{o}{.}\PY{n}{cat}\PY{o}{.}\PY{n}{set\PYZus{}categories}\PY{p}{(}\PY{n}{cats}\PY{p}{,} \PY{n}{ordered}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             \PY{k}{return} \PY{n}{input\PYZus{}df}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{k}{def} \PY{n+nf}{create\PYZus{}deathrate\PYZus{}cat}\PY{p}{(}\PY{n}{input\PYZus{}df}\PY{p}{)}\PY{p}{:}
             \PY{n}{cats} \PY{o}{=} \PY{p}{[} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{deathrate }\PY{l+s+si}{\PYZob{}0\PYZcb{}}\PY{l+s+s2}{ \PYZhy{} }\PY{l+s+si}{\PYZob{}1\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{i}\PY{p}{,} \PY{n}{i} \PY{o}{+} \PY{l+m+mi}{5}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{40}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{)} \PY{p}{]}
             \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{death\PYZus{}rate\PYZus{}cat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{cut}\PY{p}{(}\PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{demo\PYZus{}\PYZus{}death\PYZus{}rate\PYZus{}per\PYZus{}1k}\PY{p}{,} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{45}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{)}\PY{p}{,} \PY{n}{right}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{include\PYZus{}lowest}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{labels}\PY{o}{=}\PY{n}{cats}\PY{p}{)}
             \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{death\PYZus{}rate\PYZus{}cat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{death\PYZus{}rate\PYZus{}cat}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{category}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{death\PYZus{}rate\PYZus{}cat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{death\PYZus{}rate\PYZus{}cat}\PY{o}{.}\PY{n}{cat}\PY{o}{.}\PY{n}{set\PYZus{}categories}\PY{p}{(}\PY{n}{cats}\PY{p}{,} \PY{n}{ordered}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             \PY{k}{return} \PY{n}{input\PYZus{}df}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{k}{def} \PY{n+nf}{create\PYZus{}air\PYZus{}poll\PYZus{}cat}\PY{p}{(}\PY{n}{input\PYZus{}df}\PY{p}{)}\PY{p}{:}
             \PY{n}{cats} \PY{o}{=} \PY{p}{[} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{airpoll }\PY{l+s+si}{\PYZob{}0\PYZcb{}}\PY{l+s+s2}{ \PYZhy{} }\PY{l+s+si}{\PYZob{}1\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{i}\PY{p}{,} \PY{n}{i} \PY{o}{+} \PY{l+m+mi}{5}\PY{p}{)} \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{35}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{)} \PY{p}{]}
             \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{air\PYZus{}poll\PYZus{}cat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{cut}\PY{p}{(}\PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{health\PYZus{}\PYZus{}air\PYZus{}pollution\PYZus{}particulate\PYZus{}matter}\PY{p}{,} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{40}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{)}\PY{p}{,} \PY{n}{right}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{include\PYZus{}lowest}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{labels}\PY{o}{=}\PY{n}{cats}\PY{p}{)}
             \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{air\PYZus{}poll\PYZus{}cat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{air\PYZus{}poll\PYZus{}cat}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{category}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{air\PYZus{}poll\PYZus{}cat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{air\PYZus{}poll\PYZus{}cat}\PY{o}{.}\PY{n}{cat}\PY{o}{.}\PY{n}{set\PYZus{}categories}\PY{p}{(}\PY{n}{cats}\PY{p}{,} \PY{n}{ordered}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             \PY{k}{return} \PY{n}{input\PYZus{}df}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{k}{def} \PY{n+nf}{create\PYZus{}features}\PY{p}{(}\PY{n}{input\PYZus{}df}\PY{p}{)}\PY{p}{:}
             \PY{n}{input\PYZus{}df} \PY{o}{=} \PY{n}{create\PYZus{}birthrate\PYZus{}cat}\PY{p}{(}\PY{n}{input\PYZus{}df}\PY{p}{)}
             \PY{n}{input\PYZus{}df} \PY{o}{=} \PY{n}{create\PYZus{}deathrate\PYZus{}cat}\PY{p}{(}\PY{n}{input\PYZus{}df}\PY{p}{)}
             \PY{n}{input\PYZus{}df} \PY{o}{=} \PY{n}{create\PYZus{}air\PYZus{}poll\PYZus{}cat}\PY{p}{(}\PY{n}{input\PYZus{}df}\PY{p}{)}
             \PY{k}{return} \PY{n}{input\PYZus{}df}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}31}]:} \PY{n}{poverty} \PY{o}{=} \PY{n}{create\PYZus{}features}\PY{p}{(}\PY{n}{poverty}\PY{p}{)}
\end{Verbatim}


    \subsection{Data Preparation}\label{data-preparation}

This phase involves mostly the cleaning, scaling and one hot encoding of
features: * dropping redundant features * converting features to the
right type * missing values are replaced by the respective median value
of the feature. The median is prefered over the mean because it is less
sensible to skewed data and gives a better measure of centrality. *
features are scaled to have the same scale. The MinMaxScaler is applied
to the features 'health\_\_homicides\_per\_100k' and
'health\_\_motor\_vehicle\_crash\_deaths\_per\_100k' to scale them the
same way as other quantitative variables that are in percentages between
0 and 1. * One hot encoding of the categorical variables is performed

    \subsubsection{Drop columns}\label{drop-columns}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}71}]:} \PY{k}{def} \PY{n+nf}{drop\PYZus{}features}\PY{p}{(}\PY{n}{input\PYZus{}df}\PY{p}{)}\PY{p}{:}
             \PY{n}{result\PYZus{}df} \PY{o}{=} \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health\PYZus{}\PYZus{}air\PYZus{}pollution\PYZus{}particulate\PYZus{}matter}\PY{l+s+s1}{\PYZsq{}}
                                               \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{demo\PYZus{}\PYZus{}death\PYZus{}rate\PYZus{}per\PYZus{}1k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{demo\PYZus{}\PYZus{}birth\PYZus{}rate\PYZus{}per\PYZus{}1k}\PY{l+s+s1}{\PYZsq{}}
                                               \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{pct\PYZus{}65years\PYZus{}cat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{area\PYZus{}\PYZus{}urban\PYZus{}influence}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{yr}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{k}{return} \PY{n}{result\PYZus{}df}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}72}]:} \PY{n}{poverty\PYZus{}clean} \PY{o}{=} \PY{n}{drop\PYZus{}features}\PY{p}{(}\PY{n}{poverty}\PY{p}{)}
\end{Verbatim}


    \subsubsection{Convert feature to right
type}\label{convert-feature-to-right-type}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}73}]:} \PY{k}{def} \PY{n+nf}{convert\PYZus{}to\PYZus{}cat}\PY{p}{(}\PY{n}{input\PYZus{}df}\PY{p}{)}\PY{p}{:}
             \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{area\PYZus{}\PYZus{}rucc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{area\PYZus{}\PYZus{}rucc}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{category}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
             \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{econ\PYZus{}\PYZus{}economic\PYZus{}typology}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{econ\PYZus{}\PYZus{}economic\PYZus{}typology}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{category}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
             \PY{k}{return} \PY{n}{input\PYZus{}df}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}74}]:} \PY{n}{poverty\PYZus{}clean} \PY{o}{=} \PY{n}{convert\PYZus{}to\PYZus{}cat}\PY{p}{(}\PY{n}{poverty\PYZus{}clean}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}75}]:} \PY{n}{poverty\PYZus{}clean}\PY{o}{.}\PY{n}{dtypes}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}75}]:} row\_id                                                 int64
         area\_\_rucc                                          category
         econ\_\_economic\_typology                             category
         econ\_\_pct\_civilian\_labor                             float64
         econ\_\_pct\_unemployment                               float64
         econ\_\_pct\_uninsured\_adults                           float64
         econ\_\_pct\_uninsured\_children                         float64
         demo\_\_pct\_female                                     float64
         demo\_\_pct\_below\_18\_years\_of\_age                      float64
         demo\_\_pct\_aged\_65\_years\_and\_older                    float64
         demo\_\_pct\_hispanic                                   float64
         demo\_\_pct\_non\_hispanic\_african\_american              float64
         demo\_\_pct\_non\_hispanic\_white                         float64
         demo\_\_pct\_american\_indian\_or\_alaskan\_native          float64
         demo\_\_pct\_asian                                      float64
         demo\_\_pct\_adults\_less\_than\_a\_high\_school\_diploma     float64
         demo\_\_pct\_adults\_with\_high\_school\_diploma            float64
         demo\_\_pct\_adults\_with\_some\_college                   float64
         demo\_\_pct\_adults\_bachelors\_or\_higher                 float64
         health\_\_pct\_adult\_obesity                            float64
         health\_\_pct\_adult\_smoking                            float64
         health\_\_pct\_diabetes                                 float64
         health\_\_pct\_low\_birthweight                          float64
         health\_\_pct\_excessive\_drinking                       float64
         health\_\_pct\_physical\_inacticity                      float64
         health\_\_homicides\_per\_100k                           float64
         health\_\_motor\_vehicle\_crash\_deaths\_per\_100k          float64
         health\_\_pop\_per\_dentist                              float64
         health\_\_pop\_per\_primary\_care\_physician               float64
         poverty\_rate                                         float64
         aui\_pct65y\_cat                                      category
         birth\_rate\_cat                                      category
         death\_rate\_cat                                      category
         air\_poll\_cat                                        category
         dtype: object
\end{Verbatim}
            
    \subsubsection{Replace Missing Values}\label{replace-missing-values}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}76}]:} \PY{k}{def} \PY{n+nf}{clean\PYZus{}nans}\PY{p}{(}\PY{n}{input\PYZus{}df}\PY{p}{)}\PY{p}{:}
             \PY{n}{result\PYZus{}df} \PY{o}{=} \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{n}{poverty\PYZus{}clean}\PY{o}{.}\PY{n}{median}\PY{p}{(}\PY{p}{)}\PY{p}{)}
             \PY{k}{return} \PY{n}{result\PYZus{}df}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}77}]:} \PY{n}{poverty\PYZus{}clean} \PY{o}{=} \PY{n}{clean\PYZus{}nans}\PY{p}{(}\PY{n}{poverty\PYZus{}clean}\PY{p}{)}
         \PY{n}{poverty\PYZus{}clean}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}77}]:} (3198, 34)
\end{Verbatim}
            
    As we can see here under there are no missing values.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}78}]:} \PY{n}{poverty\PYZus{}clean}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}78}]:} row\_id                                               0
         area\_\_rucc                                           0
         econ\_\_economic\_typology                              0
         econ\_\_pct\_civilian\_labor                             0
         econ\_\_pct\_unemployment                               0
         econ\_\_pct\_uninsured\_adults                           0
         econ\_\_pct\_uninsured\_children                         0
         demo\_\_pct\_female                                     0
         demo\_\_pct\_below\_18\_years\_of\_age                      0
         demo\_\_pct\_aged\_65\_years\_and\_older                    0
         demo\_\_pct\_hispanic                                   0
         demo\_\_pct\_non\_hispanic\_african\_american              0
         demo\_\_pct\_non\_hispanic\_white                         0
         demo\_\_pct\_american\_indian\_or\_alaskan\_native          0
         demo\_\_pct\_asian                                      0
         demo\_\_pct\_adults\_less\_than\_a\_high\_school\_diploma     0
         demo\_\_pct\_adults\_with\_high\_school\_diploma            0
         demo\_\_pct\_adults\_with\_some\_college                   0
         demo\_\_pct\_adults\_bachelors\_or\_higher                 0
         health\_\_pct\_adult\_obesity                            0
         health\_\_pct\_adult\_smoking                            0
         health\_\_pct\_diabetes                                 0
         health\_\_pct\_low\_birthweight                          0
         health\_\_pct\_excessive\_drinking                       0
         health\_\_pct\_physical\_inacticity                      0
         health\_\_homicides\_per\_100k                           0
         health\_\_motor\_vehicle\_crash\_deaths\_per\_100k          0
         health\_\_pop\_per\_dentist                              0
         health\_\_pop\_per\_primary\_care\_physician               0
         poverty\_rate                                         0
         aui\_pct65y\_cat                                       2
         birth\_rate\_cat                                       0
         death\_rate\_cat                                       0
         air\_poll\_cat                                        28
         dtype: int64
\end{Verbatim}
            
    \subsubsection{TODO Scale Features!!!}\label{todo-scale-features}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}79}]:} \PY{k}{def} \PY{n+nf}{scale\PYZus{}features}\PY{p}{(}\PY{n}{input\PYZus{}df}\PY{p}{)}\PY{p}{:}
             \PY{n}{input\PYZus{}scale} \PY{o}{=} \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health\PYZus{}\PYZus{}homicides\PYZus{}per\PYZus{}100k}\PY{l+s+s1}{\PYZsq{}}
                                             \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health\PYZus{}\PYZus{}motor\PYZus{}vehicle\PYZus{}crash\PYZus{}deaths\PYZus{}per\PYZus{}100k}\PY{l+s+s1}{\PYZsq{}}
                                          \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health\PYZus{}\PYZus{}pop\PYZus{}per\PYZus{}dentist}\PY{l+s+s1}{\PYZsq{}}
                                          \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health\PYZus{}\PYZus{}pop\PYZus{}per\PYZus{}primary\PYZus{}care\PYZus{}physician}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{]}
             
             \PY{n}{input\PYZus{}scaled} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{MinMaxScaler}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{input\PYZus{}scale}\PY{p}{)}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{n}{input\PYZus{}scale}\PY{o}{.}\PY{n}{columns}\PY{p}{)}
             
             \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health\PYZus{}\PYZus{}homicides\PYZus{}per\PYZus{}100k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{input\PYZus{}scaled}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health\PYZus{}\PYZus{}homicides\PYZus{}per\PYZus{}100k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
             \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health\PYZus{}\PYZus{}motor\PYZus{}vehicle\PYZus{}crash\PYZus{}deaths\PYZus{}per\PYZus{}100k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{input\PYZus{}scaled}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health\PYZus{}\PYZus{}motor\PYZus{}vehicle\PYZus{}crash\PYZus{}deaths\PYZus{}per\PYZus{}100k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
             \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health\PYZus{}\PYZus{}pop\PYZus{}per\PYZus{}dentist}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{input\PYZus{}scaled}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health\PYZus{}\PYZus{}pop\PYZus{}per\PYZus{}dentist}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
             \PY{n}{input\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health\PYZus{}\PYZus{}pop\PYZus{}per\PYZus{}primary\PYZus{}care\PYZus{}physician}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{input\PYZus{}scaled}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{health\PYZus{}\PYZus{}pop\PYZus{}per\PYZus{}primary\PYZus{}care\PYZus{}physician}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
             \PY{k}{return} \PY{n}{input\PYZus{}df}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}80}]:} \PY{n}{poverty\PYZus{}clean} \PY{o}{=} \PY{n}{scale\PYZus{}features}\PY{p}{(}\PY{n}{poverty\PYZus{}clean}\PY{p}{)}
         \PY{n}{poverty\PYZus{}clean}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}80}]:}             row\_id  econ\_\_pct\_civilian\_labor  econ\_\_pct\_unemployment  \textbackslash{}
         count  3198.000000               3198.000000              3198.00000   
         mean   3156.692620                  0.467071                 0.05961   
         std    1823.959278                  0.074541                 0.02285   
         min       0.000000                  0.217000                 0.00800   
         25\%    1561.750000                  0.420000                 0.04400   
         50\%    3198.500000                  0.467000                 0.05700   
         75\%    4723.750000                  0.514000                 0.07100   
         max    6277.000000                  1.000000                 0.24000   
         
                econ\_\_pct\_uninsured\_adults  econ\_\_pct\_uninsured\_children  \textbackslash{}
         count                 3198.000000                   3198.000000   
         mean                     0.217533                      0.085915   
         std                      0.067351                      0.039993   
         min                      0.046000                      0.009000   
         25\%                      0.166250                      0.057000   
         50\%                      0.216000                      0.077000   
         75\%                      0.262000                      0.105000   
         max                      0.495000                      0.285000   
         
                demo\_\_pct\_female  demo\_\_pct\_below\_18\_years\_of\_age  \textbackslash{}
         count       3198.000000                      3198.000000   
         mean           0.498783                         0.227762   
         std            0.024243                         0.034280   
         min            0.294000                         0.098000   
         25\%            0.493000                         0.207000   
         50\%            0.503000                         0.226000   
         75\%            0.512000                         0.245000   
         max            0.576000                         0.417000   
         
                demo\_\_pct\_aged\_65\_years\_and\_older  demo\_\_pct\_hispanic  \textbackslash{}
         count                        3198.000000         3198.000000   
         mean                            0.170135            0.090199   
         std                             0.043580            0.142669   
         min                             0.043000            0.000000   
         25\%                             0.142000            0.019000   
         50\%                             0.167000            0.035000   
         75\%                             0.194000            0.088000   
         max                             0.355000            0.945000   
         
                demo\_\_pct\_non\_hispanic\_african\_american  demo\_\_pct\_non\_hispanic\_white  \textbackslash{}
         count                              3198.000000                   3198.000000   
         mean                                  0.091073                      0.770260   
         std                                   0.147068                      0.207849   
         min                                   0.000000                      0.060000   
         25\%                                   0.006000                      0.648250   
         50\%                                   0.022000                      0.854000   
         75\%                                   0.096000                      0.936000   
         max                                   0.855000                      0.998000   
         
                demo\_\_pct\_american\_indian\_or\_alaskan\_native  demo\_\_pct\_asian  \textbackslash{}
         count                                  3198.000000      3198.000000   
         mean                                      0.024648         0.013300   
         std                                       0.084609         0.025358   
         min                                       0.000000         0.000000   
         25\%                                       0.002000         0.003000   
         50\%                                       0.007000         0.007000   
         75\%                                       0.014000         0.013000   
         max                                       0.852000         0.346000   
         
                demo\_\_pct\_adults\_less\_than\_a\_high\_school\_diploma  \textbackslash{}
         count                                       3198.000000   
         mean                                           0.148794   
         std                                            0.068255   
         min                                            0.016129   
         25\%                                            0.097468   
         50\%                                            0.133501   
         75\%                                            0.195171   
         max                                            0.466867   
         
                demo\_\_pct\_adults\_with\_high\_school\_diploma  \textbackslash{}
         count                                3198.000000   
         mean                                    0.350300   
         std                                     0.070534   
         min                                     0.072821   
         25\%                                     0.305915   
         50\%                                     0.355701   
         75\%                                     0.399197   
         max                                     0.551689   
         
                demo\_\_pct\_adults\_with\_some\_college  \textbackslash{}
         count                         3198.000000   
         mean                             0.301366   
         std                              0.052498   
         min                              0.112821   
         25\%                              0.265362   
         50\%                              0.301595   
         75\%                              0.335972   
         max                              0.474216   
         
                demo\_\_pct\_adults\_bachelors\_or\_higher  health\_\_pct\_adult\_obesity  \textbackslash{}
         count                           3198.000000                 3198.00000   
         mean                               0.199540                    0.30760   
         std                                0.089158                    0.04339   
         min                                0.013986                    0.14000   
         25\%                                0.138840                    0.28400   
         50\%                                0.177247                    0.30900   
         75\%                                0.233258                    0.33400   
         max                                0.794872                    0.48400   
         
                health\_\_pct\_adult\_smoking  health\_\_pct\_diabetes  \textbackslash{}
         count                3198.000000           3198.000000   
         mean                    0.213153              0.109286   
         std                     0.058339              0.023189   
         min                     0.050000              0.033000   
         25\%                     0.178000              0.094000   
         50\%                     0.211000              0.109000   
         75\%                     0.242000              0.124000   
         max                     0.526000              0.197000   
         
                health\_\_pct\_low\_birthweight  health\_\_pct\_excessive\_drinking  \textbackslash{}
         count                  3198.000000                     3198.000000   
         mean                      0.083333                        0.164578   
         std                       0.021751                        0.041851   
         min                       0.025000                        0.038000   
         25\%                       0.069000                        0.146000   
         50\%                       0.080000                        0.164000   
         75\%                       0.094000                        0.182000   
         max                       0.232000                        0.358000   
         
                health\_\_pct\_physical\_inacticity  health\_\_homicides\_per\_100k  \textbackslash{}
         count                      3198.000000                 3198.000000   
         mean                          0.277311                    0.109051   
         std                           0.052931                    0.061427   
         min                           0.097000                    0.000000   
         25\%                           0.243000                    0.100810   
         50\%                           0.280000                    0.100810   
         75\%                           0.313000                    0.100810   
         max                           0.443000                    1.000000   
         
                health\_\_motor\_vehicle\_crash\_deaths\_per\_100k  health\_\_pop\_per\_dentist  \textbackslash{}
         count                                  3198.000000              3198.000000   
         mean                                      0.166098                 0.109243   
         std                                       0.091467                 0.089143   
         min                                       0.000000                 0.000000   
         25\%                                       0.106790                 0.055416   
         50\%                                       0.154061                 0.084599   
         75\%                                       0.207060                 0.127771   
         max                                       1.000000                 1.000000   
         
                health\_\_pop\_per\_primary\_care\_physician  poverty\_rate  
         count                             3198.000000   3198.000000  
         mean                                 0.100066     16.817136  
         std                                  0.087395      6.697969  
         min                                  0.000000      2.500000  
         25\%                                  0.054855     12.000000  
         50\%                                  0.077980     15.800000  
         75\%                                  0.110293     20.300000  
         max                                  1.000000     47.400000  
\end{Verbatim}
            
    \subsubsection{One Hot Encoding of Categorical
Variables}\label{one-hot-encoding-of-categorical-variables}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}81}]:} \PY{k}{def} \PY{n+nf}{cat\PYZus{}to\PYZus{}dummies}\PY{p}{(}\PY{n}{input\PYZus{}df}\PY{p}{)}\PY{p}{:}
             \PY{n}{result\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{get\PYZus{}dummies}\PY{p}{(}\PY{n}{input\PYZus{}df}\PY{p}{,} \PY{n}{dummy\PYZus{}na}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{area\PYZus{}\PYZus{}rucc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{econ\PYZus{}\PYZus{}economic\PYZus{}typology}\PY{l+s+s1}{\PYZsq{}}
                                                                         \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{birth\PYZus{}rate\PYZus{}cat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{death\PYZus{}rate\PYZus{}cat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{air\PYZus{}poll\PYZus{}cat}\PY{l+s+s1}{\PYZsq{}}
                                                                         \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{aui\PYZus{}pct65y\PYZus{}cat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
             \PY{k}{return} \PY{n}{result\PYZus{}df}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}82}]:} \PY{n}{poverty\PYZus{}clean} \PY{o}{=} \PY{n}{cat\PYZus{}to\PYZus{}dummies}\PY{p}{(}\PY{n}{poverty\PYZus{}clean}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}83}]:} \PY{n}{poverty\PYZus{}clean}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}83}]:} (3198, 96)
\end{Verbatim}
            
    \subsection{Modelling and Evaluation}\label{modelling-and-evaluation}

In this phase two models are compared with each other using the RMSE
evaluation metric: * Least Square Linear Model after applying recursive
feature selection to create a linear model with the most important
features * An AdaBoostRegressor which is an ensemble learning model of
decision trees.

The best RMSE scores obtained by these two models are:

\begin{longtable}[]{@{}ll@{}}
\toprule
Model & RMSE\tabularnewline
\midrule
\endhead
AdaBoostRegressor & 2.7853\tabularnewline
Linear Regression & 2.9297\tabularnewline
\bottomrule
\end{longtable}

The AdaBoostRegressor happens to be more precise than the Least Squares
Linear Model because it can handle non linear relationships. The
AdaBoostRegressor is chosen as the regression model to predict poverty
rates for United States Counties.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}84}]:} \PY{n}{rng} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{RandomState}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}85}]:} \PY{n}{poverty\PYZus{}X} \PY{o}{=} \PY{n}{poverty\PYZus{}clean}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{row\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{poverty\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{poverty\PYZus{}y} \PY{o}{=} \PY{n}{poverty\PYZus{}clean}\PY{o}{.}\PY{n}{poverty\PYZus{}rate}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}86}]:} \PY{c+c1}{\PYZsh{} use r2 adjusted in the future}
         \PY{n}{scoring} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{r2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mse}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{make\PYZus{}scorer}\PY{p}{(}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{,} \PY{n}{greater\PYZus{}is\PYZus{}better}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{p}{\PYZcb{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}87}]:} \PY{n}{inner\PYZus{}cv} \PY{o}{=} \PY{n}{ShuffleSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.3}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{n}{rng}\PY{p}{)}
         \PY{n}{outer\PYZus{}cv} \PY{o}{=} \PY{n}{ShuffleSplit}\PY{p}{(}\PY{n}{n\PYZus{}splits}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{test\PYZus{}size}\PY{o}{=}\PY{l+m+mf}{0.3}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{n}{rng}\PY{p}{)}
\end{Verbatim}


    \subsubsection{Linear Regression Feature
Selection}\label{linear-regression-feature-selection}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}153}]:} \PY{n}{caching} \PY{o}{=} \PY{n}{mkdtemp}\PY{p}{(}\PY{p}{)}
          
          \PY{n}{mse} \PY{o}{=} \PY{n}{make\PYZus{}scorer}\PY{p}{(}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{,} \PY{n}{greater\PYZus{}is\PYZus{}better}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
          
          \PY{n}{rfecv} \PY{o}{=} \PY{n}{RFECV}\PY{p}{(}\PY{n}{estimator}\PY{o}{=}\PY{n}{LinearRegression}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{step}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{n}{inner\PYZus{}cv}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{n}{mse}\PY{p}{)}
          
          \PY{n}{rfecv}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{poverty\PYZus{}X}\PY{p}{,} \PY{n}{poverty\PYZus{}y}\PY{p}{)}
          
          \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Optimal number of features : }\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{rfecv}\PY{o}{.}\PY{n}{n\PYZus{}features\PYZus{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Optimal number of features : 10

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}154}]:} \PY{n}{pprint}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{rfecv}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{[}\PY{l+m+mi}{9}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
6.4263600998374892

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}155}]:} \PY{n}{train\PYZus{}scores} \PY{o}{=} \PY{n}{cross\PYZus{}validate}\PY{p}{(}\PY{n}{rfecv}\PY{p}{,} \PY{n}{poverty\PYZus{}X}\PY{p}{,} \PY{n}{poverty\PYZus{}y}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{n}{outer\PYZus{}cv}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{n}{scoring}\PY{p}{,} \PY{n}{return\PYZus{}train\PYZus{}score}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
          \PY{n}{pprint}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{average}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{train\PYZus{}scores}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test\PYZus{}r2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}
          \PY{n}{pprint}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{average}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{train\PYZus{}scores}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test\PYZus{}mse}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
5.2670953827365532e+20
93305577491.006546

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}156}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recursive Function Elimination Linear Regression}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Number of features selected}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Cross validation score (rmse)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{rfecv}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{)} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{rfecv}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{)}\PY{p}{)}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_74_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}150}]:} \PY{n}{lin\PYZus{}ranks} \PY{o}{=} \PY{p}{[}\PY{n}{ranking} \PY{k}{for} \PY{n}{ranking} \PY{o+ow}{in} \PY{n+nb}{zip}\PY{p}{(}\PY{n}{rfecv}\PY{o}{.}\PY{n}{ranking\PYZus{}}\PY{p}{,} \PY{n}{poverty\PYZus{}X}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{p}{]}
          \PY{n+nb}{sorted}\PY{p}{(}\PY{n}{lin\PYZus{}ranks}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{25}\PY{p}{:}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}150}]:} [(2, 'econ\_\_economic\_typology\_nan'),
           (3,
            'aui\_pct65y\_cat\_Noncore adjacent to a small metro and does not contain a town of at least 2,500 residents, low\_pct\_65years'),
           (4,
            'aui\_pct65y\_cat\_Noncore adjacent to a small metro with town of at least 2,500 residents, low\_pct\_65years'),
           (5,
            'aui\_pct65y\_cat\_Micropolitan adjacent to a small metro area, low\_pct\_65years'),
           (6, 'aui\_pct65y\_cat\_Noncore adjacent to a large metro area, low\_pct\_65years'),
           (7,
            'area\_\_rucc\_Nonmetro - Completely rural or less than 2,500 urban population, not adjacent to a metro area'),
           (8,
            'area\_\_rucc\_Nonmetro - Urban population of 20,000 or more, not adjacent to a metro area'),
           (9,
            'area\_\_rucc\_Nonmetro - Urban population of 2,500 to 19,999, not adjacent to a metro area'),
           (10,
            'aui\_pct65y\_cat\_Noncore adjacent to a small metro with town of at least 2,500 residents, high\_pct\_65years'),
           (11,
            'aui\_pct65y\_cat\_Micropolitan adjacent to a large metro area, low\_pct\_65years'),
           (12,
            'aui\_pct65y\_cat\_Noncore adjacent to a small metro and does not contain a town of at least 2,500 residents, high\_pct\_65years'),
           (13,
            'aui\_pct65y\_cat\_Micropolitan adjacent to a small metro area, high\_pct\_65years'),
           (14,
            'aui\_pct65y\_cat\_Micropolitan adjacent to a large metro area, high\_pct\_65years'),
           (15,
            'aui\_pct65y\_cat\_Noncore adjacent to a large metro area, high\_pct\_65years'),
           (16, 'birth\_rate\_cat\_birthrate 30 - 35'),
           (17, 'area\_\_rucc\_nan'),
           (18, 'birth\_rate\_cat\_birthrate 35 - 40'),
           (19, 'death\_rate\_cat\_deathrate 35 - 40'),
           (20, 'birth\_rate\_cat\_nan'),
           (21,
            'area\_\_rucc\_Nonmetro - Completely rural or less than 2,500 urban population, adjacent to a metro area'),
           (22,
            'area\_\_rucc\_Nonmetro - Urban population of 2,500 to 19,999, adjacent to a metro area'),
           (23,
            'area\_\_rucc\_Nonmetro - Urban population of 20,000 or more, adjacent to a metro area'),
           (24, 'air\_poll\_cat\_airpoll 20 - 25'),
           (25, 'air\_poll\_cat\_airpoll 25 - 30'),
           (26, 'air\_poll\_cat\_airpoll 30 - 35'),
           (27,
            'aui\_pct65y\_cat\_Noncore not adjacent to a metro/micro area and does not contain a town of at least 2,500 residents, low\_pct\_65years'),
           (28,
            'aui\_pct65y\_cat\_Noncore adjacent to micro area and contains a town of 2,500-19,999 residents, low\_pct\_65years'),
           (29,
            'aui\_pct65y\_cat\_Noncore adjacent to micro area and does not contain a town of at least 2,500 residents, low\_pct\_65years'),
           (30,
            'aui\_pct65y\_cat\_Micropolitan not adjacent to a metro area, low\_pct\_65years'),
           (31,
            'aui\_pct65y\_cat\_Noncore not adjacent to a metro/micro area and contains a town of 2,500  or more residents, low\_pct\_65years'),
           (32,
            'aui\_pct65y\_cat\_Noncore adjacent to micro area and contains a town of 2,500-19,999 residents, high\_pct\_65years'),
           (33,
            'aui\_pct65y\_cat\_Micropolitan not adjacent to a metro area, high\_pct\_65years'),
           (34,
            'aui\_pct65y\_cat\_Noncore adjacent to micro area and does not contain a town of at least 2,500 residents, high\_pct\_65years'),
           (35,
            'aui\_pct65y\_cat\_Noncore not adjacent to a metro/micro area and does not contain a town of at least 2,500 residents, high\_pct\_65years'),
           (36,
            'aui\_pct65y\_cat\_Noncore not adjacent to a metro/micro area and contains a town of 2,500  or more residents, high\_pct\_65years'),
           (37, 'aui\_pct65y\_cat\_nan'),
           (38, 'air\_poll\_cat\_airpoll 0 - 5'),
           (39, 'air\_poll\_cat\_nan'),
           (40, 'air\_poll\_cat\_airpoll 10 - 15'),
           (41, 'air\_poll\_cat\_airpoll 15 - 20'),
           (42, 'air\_poll\_cat\_airpoll 5 - 10'),
           (43, 'death\_rate\_cat\_nan'),
           (44, 'demo\_\_pct\_adults\_with\_some\_college'),
           (45, 'demo\_\_pct\_adults\_bachelors\_or\_higher'),
           (46, 'demo\_\_pct\_adults\_with\_high\_school\_diploma'),
           (47, 'demo\_\_pct\_adults\_less\_than\_a\_high\_school\_diploma'),
           (48, 'death\_rate\_cat\_deathrate 30 - 35'),
           (49, 'econ\_\_pct\_unemployment'),
           (50, 'health\_\_pct\_low\_birthweight'),
           (51, 'econ\_\_pct\_uninsured\_children'),
           (52, 'econ\_\_pct\_uninsured\_adults'),
           (53, 'demo\_\_pct\_below\_18\_years\_of\_age'),
           (54, 'demo\_\_pct\_aged\_65\_years\_and\_older'),
           (55, 'econ\_\_pct\_civilian\_labor'),
           (56, 'demo\_\_pct\_female'),
           (57, 'demo\_\_pct\_american\_indian\_or\_alaskan\_native'),
           (58, 'demo\_\_pct\_non\_hispanic\_white'),
           (59, 'demo\_\_pct\_hispanic'),
           (60, 'health\_\_pct\_diabetes'),
           (61, 'health\_\_homicides\_per\_100k'),
           (62, 'demo\_\_pct\_asian'),
           (63, 'health\_\_pct\_physical\_inacticity'),
           (64, 'health\_\_pop\_per\_primary\_care\_physician'),
           (65, 'health\_\_pct\_adult\_smoking'),
           (66, 'health\_\_pct\_adult\_obesity'),
           (67, 'health\_\_pct\_excessive\_drinking'),
           (68, 'health\_\_motor\_vehicle\_crash\_deaths\_per\_100k'),
           (69, 'demo\_\_pct\_non\_hispanic\_african\_american'),
           (70, 'health\_\_pop\_per\_dentist')]
\end{Verbatim}
            
    \subsubsection{AdaBoostRegressor}\label{adaboostregressor}

After hyper parameter tuning using nested cross validation of the
AdaBoostRegressor the following parameters give the lowest RMSE score:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}157}]:} \PY{n}{adaReg} \PY{o}{=} \PY{n}{AdaBoostRegressor}\PY{p}{(}\PY{n}{base\PYZus{}estimator}\PY{o}{=}\PY{n}{DecisionTreeRegressor}\PY{p}{(}\PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{l+m+mi}{13}\PY{p}{,} \PY{n}{splitter}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{random}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{criterion}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mse}\PY{l+s+s1}{\PYZsq{}}
                                                          \PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{n}{rng}\PY{p}{)}
                                     \PY{p}{,} \PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{600}\PY{p}{,} \PY{n}{loss}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{linear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{learning\PYZus{}rate}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{n}{rng}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}158}]:} \PY{n}{param\PYZus{}grid} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{loss}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{linear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{exponential}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
                        \PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{learning\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{p}{[}\PY{l+m+mf}{0.01}\PY{p}{,} \PY{l+m+mf}{0.7}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{]}
                        \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{base\PYZus{}estimator\PYZus{}\PYZus{}min\PYZus{}samples\PYZus{}split}\PY{l+s+s1}{\PYZsq{}} \PY{p}{:} \PY{p}{[}\PY{l+m+mf}{0.01}\PY{p}{,} \PY{l+m+mf}{0.005}\PY{p}{,} \PY{l+m+mf}{0.0025}\PY{p}{]}\PY{p}{\PYZcb{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{reg\PYZus{}grid} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{estimator}\PY{o}{=}\PY{n}{adaReg}\PY{p}{,} \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{n}{param\PYZus{}grid}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{n}{scoring}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{n}{inner\PYZus{}cv}
                                \PY{p}{,} \PY{n}{error\PYZus{}score}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{refit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{mse}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{reg\PYZus{}pred} \PY{o}{=} \PY{n}{reg\PYZus{}grid}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{poverty\PYZus{}X}\PY{p}{,} \PY{n}{poverty\PYZus{}y}\PY{p}{)}
        \PY{n}{reg\PYZus{}pred}\PY{o}{.}\PY{n}{best\PYZus{}estimator\PYZus{}}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}scores} \PY{o}{=} \PY{n}{cross\PYZus{}validate}\PY{p}{(}\PY{n}{reg\PYZus{}grid}\PY{p}{,} \PY{n}{poverty\PYZus{}X}\PY{p}{,} \PY{n}{poverty\PYZus{}y}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{n}{outer\PYZus{}cv}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{n}{scoring}\PY{p}{,} \PY{n}{return\PYZus{}train\PYZus{}score}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
        \PY{n}{pprint}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{average}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{train\PYZus{}scores}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test\PYZus{}r2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}
        \PY{n}{pprint}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{average}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{train\PYZus{}scores}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test\PYZus{}mse}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \subsubsection{Feature Selection}\label{feature-selection}

To improve the AdaBoostRegressor even more, the best features are
selected using recursive feature elimination or backwards elimination.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{mse} \PY{o}{=} \PY{n}{make\PYZus{}scorer}\PY{p}{(}\PY{n}{mean\PYZus{}squared\PYZus{}error}\PY{p}{,} \PY{n}{greater\PYZus{}is\PYZus{}better}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
        
        \PY{n}{rfecv} \PY{o}{=} \PY{n}{RFECV}\PY{p}{(}\PY{n}{estimator}\PY{o}{=}\PY{n}{adaReg}\PY{p}{,} \PY{n}{step}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{n}{inner\PYZus{}cv}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{n}{mse}\PY{p}{)}
        
        \PY{n}{rfecv}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{poverty\PYZus{}X}\PY{p}{,} \PY{n}{poverty\PYZus{}y}\PY{p}{)}
        
        \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Optimal number of features : }\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s2}{\PYZdq{}} \PY{o}{\PYZpc{}} \PY{n}{rfecv}\PY{o}{.}\PY{n}{n\PYZus{}features\PYZus{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{train\PYZus{}scores} \PY{o}{=} \PY{n}{cross\PYZus{}validate}\PY{p}{(}\PY{n}{rfecv}\PY{p}{,} \PY{n}{poverty\PYZus{}X}\PY{p}{,} \PY{n}{poverty\PYZus{}y}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{n}{outer\PYZus{}cv}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{n}{scoring}\PY{p}{,} \PY{n}{return\PYZus{}train\PYZus{}score}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
        \PY{n}{pprint}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{average}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{train\PYZus{}scores}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test\PYZus{}r2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}
        \PY{n}{pprint}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{average}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{train\PYZus{}scores}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test\PYZus{}mse}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Recursive Function Elimination AdaBoostRegressor}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Number of features selected}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Cross validation score (rmse)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,} \PY{n+nb}{len}\PY{p}{(}\PY{n}{rfecv}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{)} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{sqrt}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{abs}\PY{p}{(}\PY{n}{rfecv}\PY{o}{.}\PY{n}{grid\PYZus{}scores\PYZus{}}\PY{p}{)}\PY{p}{)}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{ada\PYZus{}ranks} \PY{o}{=} \PY{p}{[}\PY{n}{ranking} \PY{k}{for} \PY{n}{ranking} \PY{o+ow}{in} \PY{n+nb}{zip}\PY{p}{(}\PY{n}{rfecv}\PY{o}{.}\PY{n}{ranking\PYZus{}}\PY{p}{,} \PY{n}{poverty\PYZus{}X}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{p}{]}
        \PY{n+nb}{sorted}\PY{p}{(}\PY{n}{lin\PYZus{}ranks}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{75}\PY{p}{:}\PY{p}{]}
\end{Verbatim}


    \subsubsection{Analysis of Predictions and
Residuals}\label{analysis-of-predictions-and-residuals}

The Analysis of the quality of the predictions and residuals shows that
the accuracy of the AdaBoostRegressor is high. However the
AdaBoostRegressor probably slightly overfits the data.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}120}]:} \PY{n}{sc1\PYZus{}tmp} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{regplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{poverty\PYZus{}y}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{n}{reg\PYZus{}grid}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{poverty\PYZus{}X}\PY{p}{)}\PY{p}{,} \PY{n}{fit\PYZus{}reg}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dodgerblue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{scatter\PYZus{}kws}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mf}{0.3}\PY{p}{\PYZcb{}}\PY{p}{)}
          \PY{n}{tmp} \PY{o}{=} \PY{n}{sc1\PYZus{}tmp}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{predictions}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{tmp} \PY{o}{=} \PY{n}{sc1\PYZus{}tmp}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Scatter plot actual poverty\PYZus{}rate Vs Predictions}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_87_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}121}]:} \PY{n}{sc2\PYZus{}tmp} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{regplot}\PY{p}{(}\PY{n}{x}\PY{o}{=}\PY{n}{reg\PYZus{}grid}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{poverty\PYZus{}X}\PY{p}{)}\PY{p}{,} \PY{n}{y}\PY{o}{=}\PY{n}{reg\PYZus{}grid}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{poverty\PYZus{}X}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{poverty\PYZus{}y}
                                \PY{p}{,} \PY{n}{fit\PYZus{}reg}\PY{o}{=}\PY{k+kc}{False}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dodgerblue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{scatter\PYZus{}kws}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{alpha}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mf}{0.3}\PY{p}{\PYZcb{}}\PY{p}{)}
          \PY{n}{tmp} \PY{o}{=} \PY{n}{sc2\PYZus{}tmp}\PY{o}{.}\PY{n}{set\PYZus{}xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{predictions}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{tmp} \PY{o}{=} \PY{n}{sc2\PYZus{}tmp}\PY{o}{.}\PY{n}{set\PYZus{}ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{residuals}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{tmp} \PY{o}{=} \PY{n}{sc2\PYZus{}tmp}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Scatter plot actual Predictions Vs Residuals}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_88_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}122}]:} \PY{n}{residuals} \PY{o}{=} \PY{n}{reg\PYZus{}grid}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{poverty\PYZus{}X}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n}{poverty\PYZus{}y}
          \PY{n}{residuals} \PY{o}{=} \PY{n}{residuals}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{residuals}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{ht\PYZus{}pov} \PY{o}{=} \PY{n}{sns}\PY{o}{.}\PY{n}{distplot}\PY{p}{(}\PY{n}{residuals}\PY{p}{,} \PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{dodgerblue}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Histogram Residuals}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_89_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{Test}\label{test}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}123}]:} \PY{n}{poverty\PYZus{}test} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./Microsoft\PYZus{}\PYZhy{}\PYZus{}DAT102x\PYZus{}Predicting\PYZus{}Poverty\PYZus{}in\PYZus{}the\PYZus{}United\PYZus{}States\PYZus{}\PYZhy{}\PYZus{}Test\PYZus{}values.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}124}]:} \PY{n}{poverty\PYZus{}test}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}124}]:} (3080, 34)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}125}]:} \PY{c+c1}{\PYZsh{}Create Features}
          \PY{n}{poverty\PYZus{}test} \PY{o}{=} \PY{n}{create\PYZus{}old\PYZus{}age\PYZus{}cat}\PY{p}{(}\PY{n}{poverty\PYZus{}test}\PY{p}{)}
          \PY{n}{poverty\PYZus{}test} \PY{o}{=} \PY{n}{create\PYZus{}aui\PYZus{}pct65y\PYZus{}cat}\PY{p}{(}\PY{n}{poverty\PYZus{}test}\PY{p}{)}
          \PY{n}{poverty\PYZus{}test} \PY{o}{=} \PY{n}{create\PYZus{}features}\PY{p}{(}\PY{n}{poverty\PYZus{}test}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}Convert to correct type}
          \PY{n}{poverty\PYZus{}test} \PY{o}{=} \PY{n}{convert\PYZus{}to\PYZus{}cat}\PY{p}{(}\PY{n}{poverty\PYZus{}test}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}Drop Features}
          \PY{n}{poverty\PYZus{}row\PYZus{}id} \PY{o}{=} \PY{n}{poverty\PYZus{}test}\PY{o}{.}\PY{n}{row\PYZus{}id}
          \PY{n}{poverty\PYZus{}test} \PY{o}{=} \PY{n}{drop\PYZus{}features}\PY{p}{(}\PY{n}{poverty\PYZus{}test}\PY{p}{)}
          \PY{n}{poverty\PYZus{}test} \PY{o}{=} \PY{n}{poverty\PYZus{}test}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{row\PYZus{}id}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}Replace NANs}
          \PY{n}{poverty\PYZus{}test\PYZus{}clean} \PY{o}{=} \PY{n}{poverty\PYZus{}test}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{n}{poverty\PYZus{}test}\PY{o}{.}\PY{n}{median}\PY{p}{(}\PY{p}{)}\PY{p}{)}
          \PY{n}{poverty\PYZus{}test\PYZus{}clean} \PY{o}{=} \PY{n}{cat\PYZus{}to\PYZus{}dummies}\PY{p}{(}\PY{n}{poverty\PYZus{}test\PYZus{}clean}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{}Scale Features}
          \PY{n}{poverty\PYZus{}test\PYZus{}clean} \PY{o}{=} \PY{n}{scale\PYZus{}features}\PY{p}{(}\PY{n}{poverty\PYZus{}test\PYZus{}clean}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}126}]:} \PY{n}{poverty\PYZus{}test\PYZus{}clean}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}126}]:} (3080, 94)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}127}]:} \PY{c+c1}{\PYZsh{}Create Prediction}
          \PY{n}{submission} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{n}{reg\PYZus{}grid}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{poverty\PYZus{}test\PYZus{}clean}\PY{p}{)}\PY{p}{)}
          \PY{n}{submission} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{clip}\PY{p}{(}\PY{n}{submission}\PY{p}{,}\PY{l+m+mf}{2.50}\PY{p}{,} \PY{l+m+mf}{48.00}\PY{p}{)}
          \PY{n}{submission}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}127}]:} (3080, 1)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}128}]:} \PY{n}{poverty\PYZus{}submission} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{poverty\PYZus{}row\PYZus{}id}\PY{p}{,} \PY{n}{submission}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
          \PY{n}{poverty\PYZus{}submission} \PY{o}{=} \PY{n}{poverty\PYZus{}submission}\PY{o}{.}\PY{n}{rename}\PY{p}{(}\PY{n}{index}\PY{o}{=}\PY{n+nb}{str}\PY{p}{,} \PY{n}{columns}\PY{o}{=}\PY{p}{\PYZob{}}\PY{l+m+mi}{0}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{poverty\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{)}
          \PY{n}{poverty\PYZus{}submission} \PY{o}{=} \PY{n}{poverty\PYZus{}submission}\PY{o}{.}\PY{n}{round}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{poverty\PYZus{}rate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{2}\PY{p}{\PYZcb{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}129}]:} \PY{n}{poverty\PYZus{}submission}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}129}]:}    row\_id  poverty\_rate
          0       1         17.89
          1       3         16.40
          2       6         13.85
          3       7         26.22
          4      14         15.10
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}130}]:} \PY{n}{poverty\PYZus{}submission}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}130}]:} (3080, 2)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}131}]:} \PY{n}{poverty\PYZus{}submission}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{n}{path\PYZus{}or\PYZus{}buf}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./MV\PYZus{}Poverty\PYZus{}Submission\PYZus{}AdaReg.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{index}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}
\end{Verbatim}


    \subsection{Conclusion}\label{conclusion}

    The Regression analysis shows that is possible to build an accurate
regression model to predict poverty rates of United States' counties
using an AdaBoostRegressor. From the data exploration phase it is clear
that economical, educational, ethnical and health related factors play
an important role in predicting poverty. However is recursive function
elemination is used to determine the optimal number of features that
leads to the best prediction.


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
